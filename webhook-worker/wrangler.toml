name = "webhook-ingestion"
main = "build/index.js"
compatibility_date = "2025-01-01"

[build]
command = "cargo install -q worker-build && worker-build --release"

[observability]
enabled = true

# D1 Database binding (same database as admin)
# NOTE: Migrations are handled by admin worker via Drizzle
# This worker only reads/writes to the database
[[d1_databases]]
binding = "DB"
database_name = "webhook-db"
database_id = "YOUR_D1_DATABASE_ID" # Replace after creating D1 database

# Environment variables
[vars]
ENVIRONMENT = "production"

# Route configuration - webhook ingestion endpoint
# Commented out for local development - uncomment for production
# [[routes]]
# pattern = "*/w/*"
# zone_name = "example.com" # Replace with your domain

# Development environment
[env.dev]
name = "webhook-ingestion-dev"
vars = { ENVIRONMENT = "development" }

# Production environment
[env.production]
name = "webhook-ingestion-prod"
vars = { ENVIRONMENT = "production" }
